# 564. å¯»æ‰¾æœ€è¿‘çš„å›æ–‡æ•°

- [ğŸ”—é¢˜ç›®é“¾æ¥](https://leetcode-cn.com/problems/find-the-closest-palindrome/)

é€»è¾‘ä¸éš¾ï¼Œè´ªå¿ƒç­–ç•¥ã€‚

å°†åŸæ•°å­—å¯¹åŠåˆ†ï¼ŒæŠŠå·¦åŠéƒ¨åˆ†åè½¬æ‹¼æ¥æˆå³åŠéƒ¨åˆ†ã€‚ç„¶åå’ŒåŸæ•°æ¯”ï¼š

- æ¯”åŸæ•°å¤§ï¼šæ‰¾åˆ°æ¯”åŸæ•°å°çš„é‚£ä¸ªå›æ–‡æ•°(å·¦åŠ-1)ï¼Œå–è·ç¦»è¿‘çš„ï¼›
- æ¯”åŸæ•°å°ï¼šæ‰¾åˆ°æ¯”åŸæ•°å¤§çš„é‚£ä¸ªå›æ–‡æ•°(å·¦åŠ+1)ï¼Œå–è·ç¦»è¿‘çš„ï¼›
- å’ŒåŸæ•°ä¸€æ ·ï¼šæ‰¾åˆ°å¤§çš„å°çš„ä¸¤ä¸ªï¼Œå–è·ç¦»è¿‘çš„

åœ¨å®é™…ç¼–ç ä¸­ï¼Œéœ€è¦è€ƒè™‘åŸæ•°å­—çš„é•¿åº¦ï¼Œå¶æ•°é•¿åº¦å¯ä»¥å¯¹åŠåˆ†ï¼Œå¥‡æ•°é•¿åº¦å°±è¦ç”¨ä¸­ä½æ•°å­—å»æ“ä½œã€‚

ä¸ºäº†é¿å…å‡ºç°è¿›ä½é€€ä½å¯¼è‡´é•¿åº¦å˜åŒ–ï¼Œéœ€è¦æŠŠ101ã€1001ã€999ã€9999è¿™æ ·çš„æ•°æ®æå‰å¤„ç†æ‰ã€‚

ç»†èŠ‚ç‚¹è¾ƒå¤šï¼ŒèŠ±äº†å¾ˆå¤šæ—¶é—´å¤„ç†ã€‚

```kotlin
/**
 * @author Yananart
 */
class Solution {
    fun nearestPalindromic(n: String): String {
        if (n.length == 1) {
            // ä¸ªä½æ•° å–æ¯”è‡ªå·±å°çš„ä¸€ä¸ª
            return (n.toInt() - 1).toString()
        }

        // åŸæ¥çš„æ•° å¯ç”¨longè¡¨ç¤º
        val o = n.toLong()

        if (strCharSum(n) == 1) {
            // ç±»ä¼¼ 10 100 1000 è¿™ç§ç›´æ¥è¿”å› 9 99 999
            return (o - 1).toString()
        }
        if (n == n.reversed()) {
            // ä¸‹é¢ä¸¤ç§å¤„ç†ä»¥å åé¢å°±ä¸ç”¨ç®¡äº† å¦åˆ™ä¼šå¾ˆå¤æ‚
            if (strCharSum(n) == 2) {
                // ç±»ä¼¼ 11 101 1001 è¿™ç§ç›´æ¥è¿”å› 9 99 999
                return (o - 2).toString()
            }
            if (n.toCharArray().all { it == '9' }) {
                // ç±»ä¼¼ 99 999 9999 è¿™ç§ç›´æ¥è¿”å› 101 1001 10001
                return (o + 2).toString()
            }
        }

        // big small ä»£è¡¨ä¸¤ä¸ªæœ€è¿‘çš„å›æ–‡æ•°
        val big: Long
        val small: Long

        if (n.length % 2 == 1) {
            // è¿™ç§æ˜¯æœ‰ä¸­ä½æ•°çš„
            val midIndex = n.length / 2
            val left = n.substring(0, midIndex)
            val mid = n[midIndex].toString().toInt()
            val right = n.substring(midIndex + 1)
            val leftReversed = left.reversed()

            if (leftReversed.toInt() > right.toInt()) {
                big = (left + mid + left.reversed()).toLong()
                // è½¬æ¢åå›æ–‡å³ä¾§æ¯”åŸæ¥çš„å¤§æˆ–ç›¸ç­‰ æ‰¾ä¸€ä¸ªæ›´å°çš„å›æ–‡å†æ¯”ä¸€æ¬¡
                small = if (mid == 0) {
                    val leftLess = (left.toInt() - 1).toString()
                    (leftLess + '9' + leftLess.reversed()).toLong()
                } else {
                    (left + (mid - 1) + leftReversed).toLong()
                }
            } else if (leftReversed.toInt() < right.toInt()) {
                small = (left + mid + left.reversed()).toLong()
                // è½¬æ¢åå›æ–‡å³ä¾§æ¯”åŸæ¥çš„å° æ‰¾ä¸€ä¸ªæ›´å¤§çš„å›æ–‡å†æ¯”ä¸€æ¬¡
                big = if (mid == 9) {
                    val leftAdd = (left.toInt() + 1).toString()
                    (leftAdd + '0' + leftAdd.reversed()).toLong()
                } else {
                    (left + (mid + 1) + leftReversed).toLong()
                }
            } else {
                // å·²ç»å›æ–‡äº† æ‰¾ä¸Šä¸‹ä¸¤ä¸ª
                small = if (mid == 0) {
                    val leftLess = (left.toInt() - 1).toString()
                    (leftLess + '9' + leftLess.reversed()).toLong()
                } else {
                    (left + (mid - 1) + leftReversed).toLong()
                }
                big = if (mid == 9) {
                    val leftAdd = (left.toInt() + 1).toString()
                    (leftAdd + '0' + leftAdd.reversed()).toLong()
                } else {
                    (left + (mid + 1) + leftReversed).toLong()
                }
            }
        } else {
            // æ²¡æœ‰ä¸­ä½æ•°
            val midIndex = n.length / 2
            val left = n.substring(0, midIndex)
            val right = n.substring(midIndex)
            val leftReversed = left.reversed()

            if (leftReversed.toInt() > right.toInt()) {
                // è½¬æ¢åå›æ–‡å³ä¾§æ¯”åŸæ¥çš„å¤§æˆ–ç›¸ç­‰ æ‰¾ä¸€ä¸ªæ›´å°çš„å›æ–‡å†æ¯”ä¸€æ¬¡
                big = (left + left.reversed()).toLong()
                val leftLess = (left.toInt() - 1).toString()
                small = (leftLess + leftLess.reversed()).toLong()
            } else if (leftReversed.toInt() < right.toInt()) {
                // è½¬æ¢åå›æ–‡å³ä¾§æ¯”åŸæ¥çš„å° æ‰¾ä¸€ä¸ªæ›´å¤§çš„å›æ–‡å†æ¯”ä¸€æ¬¡
                small = (left + left.reversed()).toLong()
                val leftAdd = (left.toInt() + 1).toString()
                big = (leftAdd + leftAdd.reversed()).toLong()
            } else {
                // å·²ç»å›æ–‡äº† æ‰¾ä¸Šä¸‹ä¸¤ä¸ª
                val leftLess = (left.toInt() - 1).toString()
                small = (leftLess + leftLess.reversed()).toLong()
                val leftAdd = (left.toInt() + 1).toString()
                big = (leftAdd + leftAdd.reversed()).toLong()
            }
        }

        return if (big - o < o - small) {
            big.toString()
        } else {
            small.toString()
        }
    }

    private fun strCharSum(str: String): Int {
        // leetcodeæ²¡æœ‰è¿™ä¸ªæ–¹æ³•å°±å¾ˆéš¾å—
        // return str.toCharArray().sumOf { it.toString().toInt() }
        var sum = 0
        str.toCharArray().forEach { sum += it.toString().toInt() }
        return sum
    }
}
```