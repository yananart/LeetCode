# 34. åœ¨æ’åºæ•°ç»„ä¸­æŸ¥æ‰¾å…ƒç´ çš„ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªä½ç½®

- [ğŸ”—é¢˜ç›®é“¾æ¥](https://leetcode-cn.com/problems/find-first-and-last-position-of-element-in-sorted-array/)

ç®€å•åšæ³•æ˜¯éå†ä¸€éå³å¯æ‰¾åˆ°ï¼Œé¢˜ç›®è¦æ±‚æ—¶é—´å¤æ‚åº¦æ˜¯`O(log(n))`ï¼Œæ‰€ä»¥ç”¨äºŒåˆ†æŸ¥æ‰¾ã€‚

æˆ‘ä»¬çš„æƒ³æ³•æ˜¯ï¼Œé€šè¿‡äºŒåˆ†æŸ¥æ‰¾ï¼Œæ‰¾åˆ°ç›®æ ‡æ•°å­—æ‰€åœ¨çš„å·¦è¾¹ç•Œå’Œå³è¾¹ç•Œã€‚

ä»¥å·¦è¾¹ç•Œä¸ºä¾‹ï¼š

- å¦‚æœæ•°ç»„ç¬¬ä¸€ä¸ªæ•°å­—ç­‰äºç›®æ ‡å€¼ï¼Œå³è¾¹ç•Œä¸º0ï¼›
- å¦‚æœæ•°ç»„ç¬¬ä¸€ä¸ªæ•°å­—å¤§äºç›®æ ‡å€¼ï¼Œä¸å­˜åœ¨ï¼›
- å¼€å§‹è¿›è¡ŒäºŒåˆ†æŸ¥æ‰¾ï¼Œä»¥æ•°ç»„è¾¹ç•Œè®¾å®šå·¦å³æŒ‡é’ˆï¼Œè®¡ç®—ä¸­é—´æŒ‡é’ˆ`mid`
    - æ‰¾å·¦è¾¹ç•Œæ—¶ä¸­é—´æŒ‡é’ˆå–é€€ä¸€æ³•ï¼Œå³5å’Œ6çš„ä¸­é—´ä½ç½®ä¸º5ï¼›æ‰¾å³è¾¹ç•Œæ—¶ä¸­é—´æŒ‡é’ˆå–è¿›ä¸€æ³•ï¼Œå³5å’Œ6çš„ä¸­é—´ä½ç½®ä¸º6
    - å½“`mid`ä½ç½®å¤§äºç›®æ ‡å€¼æ—¶ï¼Œæ›´æ–°å³æŒ‡é’ˆä¸º`mid-1`
    - å½“`mid`ä½ç½®å°äºç›®æ ‡å€¼æ—¶ï¼Œæ›´æ–°å·¦æŒ‡é’ˆä¸º`mid+1`
    - å½“`mid`ä½ç½®ç­‰äºç›®æ ‡å€¼æ—¶ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨æ‰¾å·¦è¾¹ç•Œï¼Œæ‰€ä»¥æ›´æ–°å³æŒ‡é’ˆä¸º`mid`ï¼ˆä¸æ˜¯å–`mid-1`ï¼Œå› ä¸º`mid-1`ä½ç½®å°±å¯èƒ½å°äºç›®æ ‡å€¼å°±é”™è¿‡äº†ï¼‰ï¼›æŸ¥æ‰¾å³è¾¹ç•Œæ—¶ç›¸åå°±æ˜¯æ›´æ–°å·¦æŒ‡é’ˆ
        - ä¸Šé¢è¿™ä¸ªåšæ³•å¯ä»¥ä¿è¯å·¦æŒ‡é’ˆä¸€ç›´æ˜¯å°äºç­‰äºç›®æ ‡å€¼ï¼Œä¸”å·¦æŒ‡é’ˆ-1çš„ä½ç½®ä¸€å®šæ˜¯å°äºç›®æ ‡å€¼çš„
    - ç»ˆæ­¢æ¡ä»¶æ˜¯å·¦å³æŒ‡é’ˆç›¸ç­‰
- å®ŒæˆäºŒåˆ†æŸ¥æ‰¾åå¯ä»¥ä¿è¯å½“å‰æ‰¾å‡ºçš„å·¦è¾¹ç•Œå€¼æ˜¯å°äºç­‰äºç›®æ ‡å€¼çš„ï¼š
    - å¦‚æœç­‰äºç›®æ ‡å€¼ï¼Œå°±æ˜¯æ‰¾å‡ºäº†å·¦è¾¹ç•Œï¼›
    - å¦‚æœå°äºç›®æ ‡å€¼ï¼Œè¯´æ˜ä¸å­˜åœ¨ç›®æ ‡å€¼

ç»†èŠ‚ç‚¹å¾ˆå¤šï¼Œå¯å‚è€ƒä»£ç ã€‚

```kotlin
/**
 * @author Yananart
 */
class Solution {
    companion object {
        val notExist = intArrayOf(-1, -1)
    }

    fun searchRange(nums: IntArray, target: Int): IntArray {
        if (nums.isEmpty()) {
            // ä¸å­˜åœ¨çš„åœºæ™¯
            return notExist
        }
        val left = binarySearch(nums, target, Direction.LEFT)
        if (left == -1) {
            // æ²¡æ‰¾åˆ° ä¸å­˜åœ¨
            return notExist
        }
        val right = binarySearch(nums, target, Direction.RIGHT)
        return intArrayOf(left, right)
    }

    private enum class Direction {
        LEFT, RIGHT
    }

    /**
     * äºŒåˆ†æŸ¥æ‰¾è¾¹ç•Œ
     *
     * @param nums æ•°ç»„
     * @param target ç›®æ ‡å€¼
     * @param direction è¾¹ç•Œçš„æ–¹å‘
     * @return è¾¹ç•Œçš„ä½ç½®
     */
    private fun binarySearch(nums: IntArray, target: Int, direction: Direction): Int {
        var left = 0
        var right = nums.size - 1
        when (direction) {
            Direction.LEFT -> {
                if (nums[left] == target) {
                    return 0
                } else if (nums[left] > target) {
                    return -1
                }
            }
            Direction.RIGHT -> {
                if (nums[right] == target) {
                    return right
                } else if (nums[right] < target) {
                    return -1
                }
            }
        }
        // æ‰¾åˆ°ç¬¬ä¸€ä¸ªå‡ºç°targetçš„ä½ç½®
        while (left < right) {
            // ç›®æ ‡æ˜¯æ‰¾åˆ°ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„left
            val mid = when (direction) {
                Direction.LEFT -> (left + right) / 2
                Direction.RIGHT -> (left + right + 1) / 2
            }
            if (nums[mid] > target) {
                // ä¸­é—´å€¼å¤§äºtargetï¼Œæ›´æ–°å³è¾¹ç•Œ
                right = mid - 1
            } else if (nums[mid] < target) {
                // ä¸­é—´å€¼å°äºtargetï¼Œæ›´æ–°å·¦è¾¹å±Š
                left = mid + 1
            } else {
                // çœ‹æŸ¥æ‰¾çš„æ˜¯å“ªä¸ªè¾¹ç•Œï¼Œæ›´æ–°å¦ä¸€è¾¹ç•Œ
                when (direction) {
                    Direction.LEFT -> right = mid
                    Direction.RIGHT -> left = mid
                }
            }
        }
        return when (direction) {
            Direction.LEFT -> {
                if (nums[left] == target) {
                    left
                } else {
                    -1
                }
            }
            Direction.RIGHT -> {
                if (nums[right] == target) {
                    right
                } else {
                    -1
                }
            }
        }
    }
}
```
